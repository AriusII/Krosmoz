// Copyright (c) Krosmoz 2025.
// Krosmoz licenses this file to you under the MIT license.
// See the license here https://github.com/AerafalGit/Krosmoz/blob/main/LICENSE.

using Krosmoz.Servers.GameServer.Database.Models.Experiences;
using Krosmoz.Tools.Database.Synchronizers.Base;
using Microsoft.EntityFrameworkCore;

namespace Krosmoz.Tools.Database.Synchronizers.Experiences;

/// <summary>
/// Synchronizes experience data with the database.
/// </summary>
public sealed class ExperienceSynchronizer : BaseSynchronizer
{
    /// <summary>
    /// Predefined array of experience records to be synchronized with the database.
    /// </summary>
    private static readonly ExperienceRecord[] s_experiences =
    [
        new(1, 0, 0, jobXp: 0, mountXp: 0, alignmentHonor: 0),
        new(2, 110, 1100, jobXp: 50, mountXp: 600, alignmentHonor: 500),
        new(3, 650, 6500, jobXp: 140, mountXp: 1750, alignmentHonor: 1500),
        new(4, 1500, 15000, jobXp: 271, mountXp: 2750, alignmentHonor: 3000),
        new(5, 2800, 28000, jobXp: 441, mountXp: 4000, alignmentHonor: 5000),
        new(6, 4800, 48000, jobXp: 653, mountXp: 5500, alignmentHonor: 7500),
        new(7, 7300, 73000, jobXp: 905, mountXp: 7250, alignmentHonor: 10000),
        new(8, 10500, 105000, jobXp: 1199, mountXp: 9250, alignmentHonor: 12500),
        new(9, 14500, 145000, jobXp: 1543, mountXp: 11500, alignmentHonor: 15000),
        new(10, 19200, 192000, jobXp: 1911, mountXp: 14000, alignmentHonor: 17500),
        new(11, 25200, 252000, jobXp: 2330, mountXp: 16750),
        new(12, 32600, 326000, jobXp: 2792, mountXp: 19750),
        new(13, 41000, 410000, jobXp: 3297, mountXp: 23000),
        new(14, 50500, 505000, jobXp: 3840, mountXp: 26500),
        new(15, 61000, 610000, jobXp: 4439, mountXp: 30250),
        new(16, 75000, 750000, jobXp: 5078, mountXp: 34250),
        new(17, 91000, 910000, jobXp: 5762, mountXp: 38500),
        new(18, 115000, 1150000, jobXp: 6493, mountXp: 43000),
        new(19, 142000, 1420000, jobXp: 7280, mountXp: 47750),
        new(20, 171000, 1710000, jobXp: 8097, mountXp: 52750),
        new(21, 202000, 2020000, jobXp: 8980, mountXp: 58000),
        new(22, 235000, 2350000, jobXp: 9898, mountXp: 63500),
        new(23, 270000, 2700000, jobXp: 10875, mountXp: 69250),
        new(24, 310000, 3100000, jobXp: 11903, mountXp: 75250),
        new(25, 353000, 3530000, jobXp: 12985, mountXp: 81500),
        new(26, 398500, 3985000, jobXp: 14122, mountXp: 88000),
        new(27, 448000, 4480000, jobXp: 15315, mountXp: 94750),
        new(28, 503000, 5030000, jobXp: 16564, mountXp: 101750),
        new(29, 561000, 5610000, jobXp: 17873, mountXp: 109000),
        new(30, 621600, 6216000, jobXp: 19242, mountXp: 116500),
        new(31, 687000, 6870000, jobXp: 20672, mountXp: 124250),
        new(32, 755000, 7550000, jobXp: 22166, mountXp: 132250),
        new(33, 829000, 8290000, jobXp: 23726, mountXp: 140500),
        new(34, 910000, 9100000, jobXp: 25353, mountXp: 149000),
        new(35, 1000000, 10000000, jobXp: 27048, mountXp: 157750),
        new(36, 1100000, 11000000, jobXp: 28815, mountXp: 166750),
        new(37, 1240000, 12400000, jobXp: 30656, mountXp: 176000),
        new(38, 1400000, 14000000, jobXp: 32572, mountXp: 185500),
        new(39, 1580000, 15800000, jobXp: 34566, mountXp: 195250),
        new(40, 1780000, 17800000, jobXp: 36641, mountXp: 205250),
        new(41, 2000000, 20000000, jobXp: 38800, mountXp: 215500),
        new(42, 2250000, 22500000, jobXp: 41044, mountXp: 226000),
        new(43, 2530000, 25300000, jobXp: 43378, mountXp: 236750),
        new(44, 2850000, 28500000, jobXp: 45804, mountXp: 247750),
        new(45, 3200000, 32000000, jobXp: 50946, mountXp: 259000),
        new(46, 3570000, 35700000, jobXp: 53669, mountXp: 270500),
        new(47, 3960000, 39600000, jobXp: 59437, mountXp: 282250),
        new(48, 4400000, 44000000, jobXp: 62491, mountXp: 294250),
        new(49, 4860000, 48600000, jobXp: 65664, mountXp: 306500),
        new(50, 5350000, 53500000, jobXp: 68960, mountXp: 319000),
        new(51, 5860000, 58600000, jobXp: 72385, mountXp: 331750),
        new(52, 6390000, 63900000, jobXp: 75943, mountXp: 344750),
        new(53, 6950000, 69500000, jobXp: 79640, mountXp: 358000),
        new(54, 7530000, 75300000, jobXp: 83482, mountXp: 371500),
        new(55, 8130000, 81300000, jobXp: 87475, mountXp: 385250),
        new(56, 8765100, 87651000, jobXp: 91624, mountXp: 399250),
        new(57, 9420000, 94200000, jobXp: 95937, mountXp: 413500),
        new(58, 10150000, 101500000, jobXp: 100421, mountXp: 428000),
        new(59, 10894000, 108940000, jobXp: 105082, mountXp: 442750),
        new(60, 11650000, 116500000, jobXp: 109930, mountXp: 457750),
        new(61, 12450000, 124500000, jobXp: 114971, mountXp: 473000),
        new(62, 13280000, 132800000, jobXp: 120215, mountXp: 488500),
        new(63, 14130000, 141300000, jobXp: 125671, mountXp: 504250),
        new(64, 15170000, 151700000, jobXp: 131348, mountXp: 520250),
        new(65, 16251000, 162510000, jobXp: 137256, mountXp: 536500),
        new(66, 17377000, 173770000, jobXp: 143407, mountXp: 553000),
        new(67, 18553000, 185530000, jobXp: 149811, mountXp: 569750),
        new(68, 19778000, 197780000, jobXp: 156481, mountXp: 586750),
        new(69, 21055000, 210550000, jobXp: 170669, mountXp: 604000),
        new(70, 22385000, 223850000, jobXp: 178214, mountXp: 621500),
        new(71, 23529000, 235290000, jobXp: 186080, mountXp: 639250),
        new(72, 25209000, 252090000, jobXp: 194283, mountXp: 657250),
        new(73, 26707000, 267070000, jobXp: 202839, mountXp: 675500),
        new(74, 28264000, 282640000, jobXp: 211765, mountXp: 694000),
        new(75, 29882000, 298820000, jobXp: 221082, mountXp: 712750),
        new(76, 31563000, 315630000, jobXp: 230808, mountXp: 731750),
        new(77, 33307000, 333070000, jobXp: 240964, mountXp: 751000),
        new(78, 35118000, 351180000, jobXp: 251574, mountXp: 770500),
        new(79, 36997000, 369970000, jobXp: 262660, mountXp: 790250),
        new(80, 38945000, 389450000, jobXp: 274248, mountXp: 810250),
        new(81, 40965000, 409650000, jobXp: 286364, mountXp: 830500),
        new(82, 43059000, 430590000, jobXp: 299037, mountXp: 851000),
        new(83, 45229000, 452290000, jobXp: 312297, mountXp: 871750),
        new(84, 47476000, 474760000, jobXp: 326175, mountXp: 892750),
        new(85, 49803000, 498030000, jobXp: 340705, mountXp: 914000),
        new(86, 52211000, 522110000, jobXp: 355924, mountXp: 935500),
        new(87, 54704000, 547040000, jobXp: 371870, mountXp: 957250),
        new(88, 57284000, 572840000, jobXp: 388582, mountXp: 979250),
        new(89, 59952000, 599520000, jobXp: 406106, mountXp: 1001500),
        new(90, 62712000, 627120000, jobXp: 424486, mountXp: 1024000),
        new(91, 65565000, 655650000, jobXp: 443772, mountXp: 1046750),
        new(92, 68514000, 685140000, jobXp: 464016, mountXp: 1069750),
        new(93, 71561000, 715610000, jobXp: 485274, mountXp: 1093000),
        new(94, 74710000, 747100000, jobXp: 507604, mountXp: 1116500),
        new(95, 77963000, 779630000, jobXp: 531071, mountXp: 1140250),
        new(96, 81323000, 813230000, jobXp: 555741, mountXp: 1164250),
        new(97, 84792000, 847920000, jobXp: 580000, mountXp: 1188500),
        new(98, 88374000, 883740000, jobXp: 600000, mountXp: 1213000),
        new(99, 92071000, 920710000, jobXp: 650000, mountXp: 1237750),
        new(100, 95886000, 958860000, jobXp: 700000, mountXp: 1262750),
        new(101, 99823000, 998230000, jobXp: 999999999),
        new(102, 103885000, 1038850000),
        new(103, 108075000, 1080750000),
        new(104, 112396000, 1123960000),
        new(105, 116853000, 1168530000),
        new(106, 121447000, 1214470000),
        new(107, 126184000, 1261840000),
        new(108, 131066000, 1310660000),
        new(109, 136098000, 1360980000),
        new(110, 141283000, 1412830000),
        new(111, 146626000, 1466260000),
        new(112, 152130000, 1521300000),
        new(113, 157800000, 1578000000),
        new(114, 163640000, 1636400000),
        new(115, 169655000, 1696550000),
        new(116, 175848000, 1758480000),
        new(117, 182225000, 1822250000),
        new(118, 188791000, 1887910000),
        new(119, 195550000, 1955500000),
        new(120, 202507000, 2025070000),
        new(121, 209667000, 2096670000),
        new(122, 217037000, 2170037000),
        new(123, 224620000, 2246200000),
        new(124, 232424000, 2324240000),
        new(125, 240452000, 2404520000),
        new(126, 248712000, 2487120000),
        new(127, 257209000, 2572090000),
        new(128, 265949000, 2659490000),
        new(129, 274939000, 2749390000),
        new(130, 284186000, 2841860000),
        new(131, 293694000, 2936940000),
        new(132, 303473000, 3034730000),
        new(133, 313527000, 3135270000),
        new(134, 323866000, 3236660000),
        new(135, 334495000, 3344950000),
        new(136, 345423000, 3454230000),
        new(137, 356657000, 3566570000),
        new(138, 368206000, 3682060000),
        new(139, 380076000, 3800760000),
        new(140, 392278000, 3922780000),
        new(141, 404818000, 4048180000),
        new(142, 417706000, 4177060000),
        new(143, 430952000, 4309520000),
        new(144, 444564000, 4445640000),
        new(145, 458551000, 4585510000),
        new(146, 472924000, 4729240000),
        new(147, 487693000, 4876930000),
        new(148, 502867000, 5028670000),
        new(149, 518458000, 5184580000),
        new(150, 534476000, 5344760000),
        new(151, 551000000, 5510000000),
        new(152, 567839000, 5678390000),
        new(153, 585206000, 5852060000),
        new(154, 603047000, 6030470000),
        new(155, 621374000, 6213740000),
        new(156, 640199000, 6401990000),
        new(157, 659536000, 6595360000),
        new(158, 679398000, 6793980000),
        new(159, 699798000, 6997980000),
        new(160, 720751000, 7207510000),
        new(161, 742772000, 7422720000),
        new(162, 764374000, 7643740000),
        new(163, 787074000, 7870740000),
        new(164, 810387000, 8103870000),
        new(165, 834329000, 8343290000),
        new(166, 858917000, 8589170000),
        new(167, 884167000, 8841670000),
        new(168, 910098000, 9100980000),
        new(169, 936727000, 9367270000),
        new(170, 964073000, 9640730000),
        new(171, 992154000, 9921540000),
        new(172, 1020991000, 10209910000),
        new(173, 1050603000, 10506030000),
        new(174, 1081010000, 10810100000),
        new(175, 1112235000, 11122350000),
        new(176, 1144298000, 11442980000),
        new(177, 1177222000, 11772220000),
        new(178, 1211030000, 12110300000),
        new(179, 1245745000, 12457450000),
        new(180, 1281393000, 12813930000),
        new(181, 1317997000, 13179970000),
        new(182, 1355584000, 13555840000),
        new(183, 1404179000, 14041790000),
        new(184, 1463811000, 14338110000),
        new(185, 1534506000, 14745060000),
        new(186, 1616294000, 15162940000),
        new(187, 1709205000, 15592050000),
        new(188, 1813267000, 16032670000),
        new(189, 1928513000, 16485130000),
        new(190, 2054975000, 16949750000),
        new(191, 2192686000, 17426860000),
        new(192, 2341679000, 17916460000),
        new(193, 2501990000, 18419900000),
        new(194, 2673655000, 18936550000),
        new(195, 2856710000, 19467100000),
        new(196, 3051194000, 20011940000),
        new(197, 3257146000, 20571460000),
        new(198, 3474606000, 21146060000),
        new(199, 3703616000, 21736160000),
        new(200, 7407232000, 22356230000)
    ];

    /// <summary>
    /// Synchronizes the experience data by clearing the existing records in the database
    /// and inserting the predefined experience records.
    /// </summary>
    /// <param name="cancellationToken">A token to monitor for cancellation requests.</param>
    /// <returns>A task that represents the asynchronous operation.</returns>
    public override async Task SynchronizeAsync(CancellationToken cancellationToken)
    {
        await GameDbContext.Experiences.ExecuteDeleteAsync(cancellationToken);
        GameDbContext.Experiences.AddRange(s_experiences);
        await GameDbContext.SaveChangesAsync(cancellationToken);
    }
}
